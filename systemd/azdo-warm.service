[Unit]
Description=Warm build container (keeps layers hot)
Requires=docker.service
After=docker.service

[Service]
EnvironmentFile=/opt/azdo-agent/.env
Restart=always
RestartSec=10
ExecStartPre=/usr/bin/docker pull ${WARM_IMAGE}
ExecStart=/usr/bin/docker run --rm --name azdo-warm ${WARM_IMAGE} sleep infinity
ExecStop=/usr/bin/docker stop -t 2 azdo-warm

[Install]
WantedBy=multi-user.target
